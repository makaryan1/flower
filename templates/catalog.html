{% extends "base.html" %}

{% block title %}{{ get_text('catalog') if get_text('catalog') != 'catalog' else '–ö–∞—Ç–∞–ª–æ–≥' }}{% endblock %}

{% block content %}
<div class="catalog-hero">
    <div class="container">
        <h1 class="catalog-title">{{ get_text('catalog') if get_text('catalog') != 'catalog' else '–ö–∞—Ç–∞–ª–æ–≥ —Ü–≤–µ—Ç–æ–≤' }}</h1>
        <p class="catalog-subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Å–∞–º—ã–µ –∫—Ä–∞—Å–∏–≤—ã–µ —Ü–≤–µ—Ç—ã –¥–ª—è –æ—Å–æ–±—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤</p>
    </div>
</div>

<div class="catalog-container">
    <div class="container">
        <!-- Filter Section -->
        <div class="filter-section">
            <div class="filter-buttons">
                <button class="filter-btn active" data-category="all">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
                <button class="filter-btn" data-category="roses">–†–æ–∑—ã</button>
                <button class="filter-btn" data-category="tulips">–¢—é–ª—å–ø–∞–Ω—ã</button>
                <button class="filter-btn" data-category="bouquets">–ë—É–∫–µ—Ç—ã</button>
                <button class="filter-btn" data-category="seasonal">–°–µ–∑–æ–Ω–Ω—ã–µ</button>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid">
            {% for product in products %}
            <div class="product-card" data-category="{{ product.category }}">
                <div class="product-image-wrapper">
                    {% if product.image_url %}
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" class="product-image">
                    {% else %}
                        <div class="product-image-placeholder">
                            <i class="flower-icon">üå∏</i>
                        </div>
                    {% endif %}

                    {% if product.stock <= 5 and product.stock > 0 %}
                        <span class="stock-badge low-stock">–û—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ</span>
                    {% elif product.stock == 0 %}
                        <span class="stock-badge out-of-stock">–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</span>
                    {% endif %}

                    <div class="product-overlay">
                        <a href="{{ url_for('product_detail', id=product.id) }}" class="view-btn">
                            <i class="icon">üëÅ</i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </a>
                    </div>
                </div>

                <div class="product-info">
                    <h3 class="product-name">{{ product.name }}</h3>
                    <p class="product-description">{{ product.description[:80] }}{% if product.description|length > 80 %}...{% endif %}</p>

                    <div class="product-bottom">
                        <div class="price-section">
                            <span class="product-price">{{ product.price }} ‚Çæ</span>
                            {% if product.category == 'seasonal' %}
                                <span class="original-price">{{ (product.price * 1.2)|round|int }} ‚Çæ</span>
                            {% endif %}
                        </div>

                        {% if product.stock > 0 %}
                            <form action="{{ url_for('add_to_cart', product_id=product.id) }}" method="post" class="add-to-cart-form">
                                <button type="submit" class="add-to-cart-btn">
                                    <i class="cart-icon">üõí</i>
                                    –í –∫–æ—Ä–∑–∏–Ω—É
                                </button>
                            </form>
                        {% else %}
                            <button class="add-to-cart-btn disabled" disabled>
                                –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
                            </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        {% if not products %}
        <div class="empty-catalog">
            <div class="empty-icon">üå∫</div>
            <h3>–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</h3>
            <p>–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞</p>
        </div>
        {% endif %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.filter-btn');
    const productCards = document.querySelectorAll('.product-card');

    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons
            filterButtons.forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            this.classList.add('active');

            const category = this.getAttribute('data-category');

            productCards.forEach(card => {
                if (category === 'all' || card.getAttribute('data-category') === category) {
                    card.style.display = 'block';
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 10);
                } else {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        card.style.display = 'none';
                    }, 300);
                }
            });
        });
    });

    // Add to cart animation
    const addToCartForms = document.querySelectorAll('.add-to-cart-form');
    addToCartForms.forEach(form => {
        form.addEventListener('submit', function(e) {
            const button = this.querySelector('.add-to-cart-btn');
            button.classList.add('adding');
            button.innerHTML = '<i class="cart-icon">‚úì</i> –î–æ–±–∞–≤–ª–µ–Ω–æ!';

            setTimeout(() => {
                button.classList.remove('adding');
                button.innerHTML = '<i class="cart-icon">üõí</i> –í –∫–æ—Ä–∑–∏–Ω—É';
            }, 2000);
        });
    });
});
</script>
{% endblock %}